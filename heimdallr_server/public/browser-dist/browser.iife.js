var HEIMDALLR_BROWSER=function(){"use strict";var t,e=((t=e||{}).NAME="@heimdallr-sdk",t);const n="[@heimdallr-sdk]:";var r=(t=>(t[t.FATAL=1]="FATAL",t[t.ERROR=2]="ERROR",t[t.WARN=3]="WARN",t[t.INFO=4]="INFO",t[t.DEBUG=5]="DEBUG",t))(r||{}),s=(t=>(t.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",t.USER_ID="HEIMDALLR_SDK_USER_ID",t.APP="HEIMDALLR_SDK_APP_ID",t))(s||{}),o=(t=>(t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t))(o||{}),E=(t=>(t[t.LIFECYCLE=1]="LIFECYCLE",t[t.ERROR=2]="ERROR",t[t.PERFORMANCE=3]="PERFORMANCE",t[t.API=4]="API",t[t.DOM=5]="DOM",t[t.ROUTE=6]="ROUTE",t[t.CONSOLE=7]="CONSOLE",t[t.RECORD=8]="RECORD",t[t.VUE=9]="VUE",t[t.CUSTOMER=10]="CUSTOMER",t[t.EXTEND=11]="EXTEND",t))(E||{}),i=(t=>(t[t.CODEERROR=21]="CODEERROR",t[t.RESOURCEERROR=22]="RESOURCEERROR",t[t.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",t[t.PAGECRASH=24]="PAGECRASH",t))(i||{}),R=(t=>(t[t.BEACON=1]="BEACON",t[t.IMG=2]="IMG",t[t.GET=3]="GET",t[t.POST=4]="POST",t))(R||{}),O=(t=>(t[t.CLICK=51]="CLICK",t))(O||{}),a=(t=>(t.LOG="log",t.INFO="info",t.WARN="warn",t.ERROR="error",t.ASSERT="assert",t))(a||{}),c=(t=>(t[t.XHR=41]="XHR",t[t.FETCH=42]="FETCH",t))(c||{}),l=(t=>(t[t.FMP=31]="FMP",t[t.FPS=32]="FPS",t[t.BASIC=33]="BASIC",t[t.VITALS=34]="VITALS",t[t.RESOURCE=35]="RESOURCE",t))(l||{}),C=(t=>(t[t.HASH=61]="HASH",t[t.HISTORY=62]="HISTORY",t))(C||{}),S=(t=>(t[t.CUSTOMER=111]="CUSTOMER",t))(S||{}),u=(t=>(t.LOCAL="local",t.SESSION="session",t.COOKIE="cookie",t.GLOBAL="global",t))(u||{}),I=(t=>(t[t.LOAD=11]="LOAD",t[t.UNLOAD=12]="UNLOAD",t))(I||{}),L=(t=>(t[t.MOBILE=1]="MOBILE",t[t.PC=2]="PC",t))(L||{}),T=(t=>(t[t.BROWSER=1]="BROWSER",t[t.WECHAT=2]="WECHAT",t[t.NODE=3]="NODE",t))(T||{}),d=(t=>(t[t.ROUTE=11]="ROUTE",t[t.CLICK=12]="CLICK",t[t.CONSOLE=13]="CONSOLE",t[t.XHR=14]="XHR",t[t.FETCH=15]="FETCH",t[t.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",t[t.RESOURCE=17]="RESOURCE",t[t.CODE_ERROR=18]="CODE_ERROR",t[t.CUSTOMER=19]="CUSTOMER",t[t.FRAMEWORK=20]="FRAMEWORK",t[t.LIFECYCLE=21]="LIFECYCLE",t[t.CRASH=22]="CRASH",t))(d||{}),A=(t=>(t[t.API=21]="API",t[t.ROUTE=22]="ROUTE",t[t.CLICK=23]="CLICK",t[t.ERROR=24]="ERROR",t[t.LIFECYCLE=25]="LIFECYCLE",t[t.CUSTOMER=26]="CUSTOMER",t))(A||{});const p=(t,e,n)=>{if(!e)return;const r=(t=>{let e=null;switch(t){case u.LOCAL:e=localStorage;break;case u.SESSION:e=sessionStorage}return e})(t);r&&r.setItem(e,JSON.stringify(n))};var h=Object.defineProperty,f=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,U=(t,e,n)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const m=(t,e)=>`${/^http(s|):\/\//.test(t||"")?t:`//${(t||"").replace(/^http(s|):\/\//,"")}`}/${"/"===(e||"")[0]?e.substring(1):e}`,P=(t,e)=>{if(!t||!e)return null;const n=((t,e)=>{for(var n in e||(e={}))D.call(e,n)&&U(t,n,e[n]);if(f)for(var n of f(e))N.call(e,n)&&U(t,n,e[n]);return t})({},e),r=t.split(".");let s=n;for(const t of r){const e=s[t];if(!e)return null;s=e}return s},g=t=>Object.keys(t).map((e=>{const n=t[e];return`${encodeURIComponent(e)}=${encodeURIComponent("string"!=typeof n?JSON.stringify(n):n)}`})).join("&"),H=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));var b,y,M=((b=M||{}).NAME="@heimdallr-sdk",b),w=((y=w||{})[y.FATAL=1]="FATAL",y[y.ERROR=2]="ERROR",y[y.WARN=3]="WARN",y[y.INFO=4]="INFO",y[y.DEBUG=5]="DEBUG",y),F=(t=>(t.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",t.USER_ID="HEIMDALLR_SDK_USER_ID",t.APP="HEIMDALLR_SDK_APP_ID",t))(F||{}),x=(t=>(t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t))(x||{}),_=(t=>(t[t.LIFECYCLE=1]="LIFECYCLE",t[t.ERROR=2]="ERROR",t[t.PERFORMANCE=3]="PERFORMANCE",t[t.API=4]="API",t[t.DOM=5]="DOM",t[t.ROUTE=6]="ROUTE",t[t.CONSOLE=7]="CONSOLE",t[t.RECORD=8]="RECORD",t[t.VUE=9]="VUE",t[t.CUSTOMER=10]="CUSTOMER",t[t.EXTEND=11]="EXTEND",t))(_||{}),v=(t=>(t[t.CODEERROR=21]="CODEERROR",t[t.RESOURCEERROR=22]="RESOURCEERROR",t[t.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",t[t.PAGECRASH=24]="PAGECRASH",t))(v||{}),B=(t=>(t[t.BEACON=1]="BEACON",t[t.IMG=2]="IMG",t[t.GET=3]="GET",t[t.POST=4]="POST",t))(B||{}),G=(t=>(t[t.CLICK=51]="CLICK",t))(G||{}),k=(t=>(t.LOG="log",t.INFO="info",t.WARN="warn",t.ERROR="error",t.ASSERT="assert",t))(k||{}),K=(t=>(t[t.XHR=41]="XHR",t[t.FETCH=42]="FETCH",t))(K||{}),W=(t=>(t[t.FMP=31]="FMP",t[t.FPS=32]="FPS",t[t.BASIC=33]="BASIC",t[t.VITALS=34]="VITALS",t[t.RESOURCE=35]="RESOURCE",t))(W||{}),j=(t=>(t[t.HASH=61]="HASH",t[t.HISTORY=62]="HISTORY",t))(j||{}),Y=(t=>(t[t.CUSTOMER=111]="CUSTOMER",t))(Y||{}),$=(t=>(t.LOCAL="local",t.SESSION="session",t.COOKIE="cookie",t.GLOBAL="global",t))($||{}),J=(t=>(t[t.LOAD=11]="LOAD",t[t.UNLOAD=12]="UNLOAD",t))(J||{}),X=(t=>(t[t.MOBILE=1]="MOBILE",t[t.PC=2]="PC",t))(X||{}),V=(t=>(t[t.BROWSER=1]="BROWSER",t[t.WECHAT=2]="WECHAT",t[t.NODE=3]="NODE",t))(V||{}),Q=(t=>(t[t.ROUTE=11]="ROUTE",t[t.CLICK=12]="CLICK",t[t.CONSOLE=13]="CONSOLE",t[t.XHR=14]="XHR",t[t.FETCH=15]="FETCH",t[t.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",t[t.RESOURCE=17]="RESOURCE",t[t.CODE_ERROR=18]="CODE_ERROR",t[t.CUSTOMER=19]="CUSTOMER",t[t.FRAMEWORK=20]="FRAMEWORK",t[t.LIFECYCLE=21]="LIFECYCLE",t[t.CRASH=22]="CRASH",t))(Q||{}),q=(t=>(t[t.API=21]="API",t[t.ROUTE=22]="ROUTE",t[t.CLICK=23]="CLICK",t[t.ERROR=24]="ERROR",t[t.LIFECYCLE=25]="LIFECYCLE",t[t.CUSTOMER=26]="CUSTOMER",t))(q||{});const z=t=>{let e=null;switch(t){case $.LOCAL:e=localStorage;break;case $.SESSION:e=sessionStorage}return e},Z=(t,e,n=!0)=>{if(!t||!e)return"";const r=z(t);if(!r)return"";let s="";try{const t=e.split("."),[o]=t;s=r.getItem(o),n&&(s=JSON.parse(s),t.length>1&&(s=t.slice(1).reduce(((t,e)=>t[e]),s)))}catch(t){console.error("[@heimdallr-sdk]:",t)}return s},tt=(t,e,n)=>{if(!e)return;const r=z(t);r&&r.setItem(e,JSON.stringify(n))},et=t=>{if(!t)return"";const e=document.cookie.match(new RegExp(`(^| )${t}=([^;]*)(;|$)`));return null!=e?decodeURIComponent(e[2]):""},nt=(t,e,n)=>new Promise(((r,s)=>{const o=new XMLHttpRequest;if(t===x.GET&&n){const t=new URLSearchParams(n),r=e.includes("?")?"&":"?";e+=`${r}${t.toString()}`}o.open(t,e,!0),t!==x.GET&&("string"==typeof n||n instanceof URLSearchParams?o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):o.setRequestHeader("Content-Type","application/json;charset=UTF-8")),o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){const t=(t=>{const e={};return t.trim().split(/[\r\n]+/).forEach((t=>{const[n,r]=t.split(": ");e[n]=r})),e})(o.getAllResponseHeaders());if(o.status>=200&&o.status<300){try{const e=o.responseText?JSON.parse(o.responseText):null;r({status:o.status,statusText:o.statusText,headers:t,data:e})}catch(t){s(new Error(`Failed to parse response: ${o.responseText}`))}return}s({status:o.status,statusText:o.statusText,headers:t,data:o.responseText})}},o.onerror=()=>{s(new Error("Network error"))};try{if(t!==x.GET)return"string"==typeof n||n instanceof URLSearchParams?void o.send(n):void o.send(JSON.stringify(n));o.send()}catch(t){s(t)}}));var rt,st=((rt=st||{}).NAME="@heimdallr-sdk",rt);const ot="[@heimdallr-sdk]:";var Et,it=((Et=it||{})[Et.FATAL=1]="FATAL",Et[Et.ERROR=2]="ERROR",Et[Et.WARN=3]="WARN",Et[Et.INFO=4]="INFO",Et[Et.DEBUG=5]="DEBUG",Et),Rt=(t=>(t.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",t.USER_ID="HEIMDALLR_SDK_USER_ID",t.APP="HEIMDALLR_SDK_APP_ID",t))(Rt||{}),Ot=(t=>(t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t))(Ot||{}),at=(t=>(t[t.LIFECYCLE=1]="LIFECYCLE",t[t.ERROR=2]="ERROR",t[t.PERFORMANCE=3]="PERFORMANCE",t[t.API=4]="API",t[t.DOM=5]="DOM",t[t.ROUTE=6]="ROUTE",t[t.CONSOLE=7]="CONSOLE",t[t.RECORD=8]="RECORD",t[t.VUE=9]="VUE",t[t.CUSTOMER=10]="CUSTOMER",t[t.EXTEND=11]="EXTEND",t))(at||{}),ct=(t=>(t[t.CODEERROR=21]="CODEERROR",t[t.RESOURCEERROR=22]="RESOURCEERROR",t[t.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",t[t.PAGECRASH=24]="PAGECRASH",t))(ct||{}),lt=(t=>(t[t.BEACON=1]="BEACON",t[t.IMG=2]="IMG",t[t.GET=3]="GET",t[t.POST=4]="POST",t))(lt||{}),Ct=(t=>(t[t.CLICK=51]="CLICK",t))(Ct||{}),St=(t=>(t.LOG="log",t.INFO="info",t.WARN="warn",t.ERROR="error",t.ASSERT="assert",t))(St||{}),ut=(t=>(t[t.XHR=41]="XHR",t[t.FETCH=42]="FETCH",t))(ut||{}),It=(t=>(t[t.FMP=31]="FMP",t[t.FPS=32]="FPS",t[t.BASIC=33]="BASIC",t[t.VITALS=34]="VITALS",t[t.RESOURCE=35]="RESOURCE",t))(It||{}),Lt=(t=>(t[t.HASH=61]="HASH",t[t.HISTORY=62]="HISTORY",t))(Lt||{}),Tt=(t=>(t[t.CUSTOMER=111]="CUSTOMER",t))(Tt||{}),dt=(t=>(t.LOCAL="local",t.SESSION="session",t.COOKIE="cookie",t.GLOBAL="global",t))(dt||{}),At=(t=>(t[t.LOAD=11]="LOAD",t[t.UNLOAD=12]="UNLOAD",t))(At||{}),pt=(t=>(t[t.MOBILE=1]="MOBILE",t[t.PC=2]="PC",t))(pt||{}),ht=(t=>(t[t.BROWSER=1]="BROWSER",t[t.WECHAT=2]="WECHAT",t[t.NODE=3]="NODE",t))(ht||{}),ft=(t=>(t[t.ROUTE=11]="ROUTE",t[t.CLICK=12]="CLICK",t[t.CONSOLE=13]="CONSOLE",t[t.XHR=14]="XHR",t[t.FETCH=15]="FETCH",t[t.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",t[t.RESOURCE=17]="RESOURCE",t[t.CODE_ERROR=18]="CODE_ERROR",t[t.CUSTOMER=19]="CUSTOMER",t[t.FRAMEWORK=20]="FRAMEWORK",t[t.LIFECYCLE=21]="LIFECYCLE",t[t.CRASH=22]="CRASH",t))(ft||{}),Dt=(t=>(t[t.API=21]="API",t[t.ROUTE=22]="ROUTE",t[t.CLICK=23]="CLICK",t[t.ERROR=24]="ERROR",t[t.LIFECYCLE=25]="LIFECYCLE",t[t.CUSTOMER=26]="CUSTOMER",t))(Dt||{});class Nt{constructor(){this.dep=new Map}watch(t,e){const n=this.dep.get(t);n?this.dep.set(t,n.concat(e)):this.dep.set(t,[e])}notify(t,e){const n=this.dep.get(t);t&&n&&n.forEach((t=>{try{t(e)}catch(t){console.error(t)}}))}}var Ut=Object.defineProperty,mt=Object.getOwnPropertySymbols,Pt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,Ht=(t,e,n)=>e in t?Ut(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bt=(t,e)=>{for(var n in e||(e={}))Pt.call(e,n)&&Ht(t,n,e[n]);if(mt)for(var n of mt(e))gt.call(e,n)&&Ht(t,n,e[n]);return t};class yt{constructor(t){this.options=t,this.initConsole(),this.isRightEnv()?(this.bindOptions(),this.isReady=!1,this.taskQueue=[],this.initAPP().then((t=>{t&&this.appID!==t&&(this.appID=t),this.isReady=!0,this.executeTaskQueue()}))):console.warn(ot,"Client does not match the environment")}initConsole(){const{debug:t}=this.options;t&&"undefined"!=typeof console||Object.keys(St).forEach((t=>{console[t]=()=>null}))}bindOptions(){const{dsn:t,app:e,debug:n=!1,enabled:r=!0}=this.options;if(!e||!t)return void console.warn(ot,"Missing app or dsn in options");const{host:s,init:o,report:E=""}=t,i=m(s,o),R=m(s,E);this.context={app:e,uploadUrl:R,initUrl:i,debug:n,enabled:r}}use(t){const{uploadUrl:e,enabled:n}=this.context,r=new Nt,s=new Map;for(const o of t){const{name:t,monitor:E,transform:i}=o||{};if(!t||!E){console.warn("The plugin missing name or monitor.");continue}if(s.has(t)){console.warn(`The plugin name [${t}] is duplicate, please modify it.`);continue}s.set(t,1);try{E.call(this,r.notify.bind(r,t))}catch(t){console.error(t)}const R=(...t)=>{const r="function"==typeof i?i.apply(this,t):t;if(!r)return;const s=this.transform(r);s&&n&&(this.isReady?this.nextTick(this.report,this,e,bt({aid:this.appID},s)):this.taskQueue.push(s))};r.watch(t,R)}}executeTaskQueue(){const{uploadUrl:t}=this.context;for(;this.taskQueue.length;){const e=this.taskQueue.shift();this.nextTick(this.report,this,t,bt({aid:this.appID},e))}}getClientOptions(){return bt({},this.options)}getContext(){return bt({},this.context)}}class Mt{constructor(t={}){this.maxBreadcrumbs=t.maxBreadcrumbs||80,this.stack=[]}unshift(t){return t.l||(t.l=it.INFO),this.stack.length>=this.maxBreadcrumbs&&this.pop(),this.stack.unshift(t),this.stack.sort(((t,e)=>e.t-t.t)),this.stack}pop(){return void 0!==this.stack.pop()}clear(){this.stack=[]}getStack(){return this.stack.slice(0)}}const wt=[];let Ft,xt=!1;const _t="undefined"!=typeof Promise?Promise.resolve():null,vt=()=>{xt=!1;const t=wt.slice(0);wt.length=0;for(const e of t)e()};if(_t)Ft=()=>{_t.then(vt).catch((t=>console.error(t)))};else if("undefined"!=typeof MutationObserver&&"[object MutationObserverConstructor]"===MutationObserver.toString()){let t=1;const e=new MutationObserver(vt),n=document.createTextNode(String(t));e.observe(n,{characterData:!0}),Ft=()=>{t=(t+1)%2,n.data=String(t)}}else Ft=()=>{setTimeout(vt,0)};const Bt=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Gt=t=>{const e=t.match(Bt);if(!e)return{};return{filename:e[2],functionName:e[1]||"",lineno:parseInt(e[3],10)||void 0,colno:parseInt(e[4],10)||void 0}};var kt=Object.defineProperty,Kt=Object.getOwnPropertySymbols,Wt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable,Yt=(t,e,n)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$t=(t,e)=>{for(var n in e||(e={}))Wt.call(e,n)&&Yt(t,n,e[n]);if(Kt)for(var n of Kt(e))jt.call(e,n)&&Yt(t,n,e[n]);return t};const Jt="HEIMDALLR_SDK_ERROR_CACHE",Xt=t=>window.btoa(encodeURIComponent(JSON.stringify(t))),Vt=t=>{const{stkLimit:e=3}=t;return{name:"jsErrorPlugin",monitor(t){window.addEventListener("error",(e=>{e.preventDefault(),console.error(n,e),t({category:E.ERROR,data:e})}),!0)},transform(t){const{category:n,data:s}=t,{localName:o,src:E,href:R}=s.target||{},O=H();let a=Z(u.SESSION,Jt);if(Array.isArray(a)||(a=[]),o){const t={source:o,href:E||R};this.breadcrumb.unshift({lid:O,bt:d.RESOURCE,l:r.FATAL,msg:`Unable to load "${t.href}"`,t:this.getTime()});const e=Xt(t);return a.includes(e)?null:(a.push(e),tt(u.SESSION,Jt,a),{lid:O,t:this.getTime(),e:n,dat:$t({st:i.RESOURCEERROR},t)})}const{message:c,error:l}=s;this.breadcrumb.unshift({lid:O,bt:d.CODE_ERROR,l:r.ERROR,msg:c,t:this.getTime()});const C=((t,e=3)=>{const{stack:n}=t;if(!n)return[];const r=[];for(const t of n.split("\n").slice(1)){const e=Gt(t);e&&r.push(e)}return r.slice(0,e)})(l,e),S=C.map((({lineno:t,colno:e,filename:n,functionName:r})=>({lin:t,col:e,file:n,fn:r}))),[I]=S,L=Xt($t({msg:c},I));return a.includes(L)?null:(a.push(L),tt(u.SESSION,Jt,a),{lid:O,t:this.getTime(),e:n,dat:{st:i.CODEERROR,msg:c,stk:S}})}}},Qt={name:"promiseErrorPlugin",monitor(t){window.addEventListener("unhandledrejection",(e=>{e.preventDefault(),console.error(n,e),t({category:E.ERROR,data:e})}))},transform(t){const{category:e,data:{reason:n}}=t;let s;"string"==typeof n?s=n:"object"==typeof n&&n.stack&&(s=n.stack);const o=H();return this.breadcrumb.unshift({lid:o,bt:d.UNHANDLEDREJECTION,l:r.ERROR,msg:s,t:this.getTime()}),{lid:o,t:this.getTime(),e:e,dat:{st:i.UNHANDLEDREJECTION,msg:s}}}};var qt=Object.defineProperty,zt=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,ee=(t,e,n)=>e in t?qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ne=(t,e)=>{for(var n in e||(e={}))Zt.call(e,n)&&ee(t,n,e[n]);if(zt)for(var n of zt(e))te.call(e,n)&&ee(t,n,e[n]);return t};function re(t){let e="";const{name:r,position:s}=t;return r&&s&&(e=function(t={}){const{name:e="",position:n=""}=t;switch(n){case u.LOCAL:case u.SESSION:return Z(n,e);case u.COOKIE:return et(e);case u.GLOBAL:return P(e,window)}return""}(t),e||console.warn(n,`${r} does not exist on ${s}`)),{acc:e}}function se(t={}){const{userIdentify:e={}}=t;return{name:"lifeCyclePlugin",monitor(t){window.addEventListener("load",(()=>{this.sessionID=Z(u.SESSION,s.SESSION_ID),this.sessionID||(this.sessionID=H(),tt(u.SESSION,s.SESSION_ID,this.sessionID)),t(ne({lt:I.LOAD,href:location.href},re.call(this,e)))})),window.addEventListener("unload",(()=>{t(ne({lt:I.UNLOAD,href:location.href},re.call(this,e)))}))},transform(t){const e=H(),{lt:n}=t;let r=[];if(n===I.UNLOAD)r=[...this.breadcrumb.getStack()];return delete t.lt,{lid:e,t:this.getTime(),e:E.LIFECYCLE,b:r,dat:ne({st:n},t)}}}}var oe=Object.defineProperty,Ee=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,Oe=(t,e,n)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ae=(t,e)=>{for(var n in e||(e={}))ie.call(e,n)&&Oe(t,n,e[n]);if(Ee)for(var n of Ee(e))Re.call(e,n)&&Oe(t,n,e[n]);return t};class ce extends yt{constructor(t){super(t),this.diff=0,this.breadcrumb=new Mt(t)}initAPP(){return t=this,e=null,n=function*(){const{initUrl:t,app:e}=this.getContext(),{headers:{date:n},data:{data:r}={}}=yield this.report(t,e,R.GET);this.setDiff(n);const{id:o=""}=r||{};return p(u.LOCAL,s.APP,o),o},new Promise(((r,s)=>{var o=t=>{try{i(n.next(t))}catch(t){s(t)}},E=t=>{try{i(n.throw(t))}catch(t){s(t)}},i=t=>t.done?r(t.value):Promise.resolve(t.value).then(o,E);i((n=n.apply(t,e)).next())}));var t,e,n}isRightEnv(){return"undefined"!=typeof window}report(t,e,n=R.BEACON){if(n===R.BEACON&&navigator.sendBeacon)((t,e)=>{if(!t||"string"!=typeof t)return console.error("Invalid URL"),!1;if(!e||"object"!=typeof e)return console.error("Invalid data"),!1;const n=new FormData;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];"string"==typeof r||r instanceof Blob||(r=JSON.stringify(r)),n.append(t,r)}navigator.sendBeacon(t,n)})(t,e);else if(n!==R.IMG&&navigator.sendBeacon){if(n!==R.POST)return((t,e)=>nt(x.GET,t,e))(t,e);((t,e)=>{nt(x.POST,t,e)})(t,g(e))}else((t,e)=>{const n=g(e),r=t.includes("?")?"&":"?",s=`${t}${r}${n}`,o=new Image;o.src=s,setTimeout((()=>{o.src=""}),0)})(t,e)}transform(t){if(!t)return null;if(!this.sessionID&&(this.sessionID=Z(u.SESSION,s.SESSION_ID),!this.sessionID))return null;let e=et(s.USER_ID);e||(e=H(),((t,e,n)=>{if(!t||!e||!n)return;const r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),document.cookie=`${t}=${encodeURIComponent(e)};expires=${r.toUTCString()}`})(s.USER_ID,e,180));let n={};const{dat:{st:r}}=t,{href:o}=location;if(r===I.LOAD){const{userAgent:t,language:e}=navigator,{title:r,documentElement:s,body:o}=document,{innerWidth:E,innerHeight:i}=window;n={ttl:r,lan:e,ua:t,ws:`${E}x${i}`,ds:`${s.clientWidth||o.clientWidth}x${s.clientHeight||o.clientHeight}`}}return ae(ae({sid:this.sessionID,uid:e,p:T.BROWSER,url:o},n),t)}nextTick(t,e,...n){return function(t,e,...n){let r;if(wt.push((()=>{if(t)try{t.call(e,...n)}catch(t){console.error(t)}else r&&r(n)})),xt||(xt=!0,Ft()),!t&&"undefined"!=typeof Promise)return new Promise((t=>{r=t}))}(t,e,...n)}setDiff(t){const e=new Date(t),n=Date.now()-e.getTime();(!this.diff||this.diff>n)&&(this.diff=n)}getTime(){return Date.now()-(this.diff||0)}}return t=>{const e=new ce(t),{plugins:n=[]}=t;e.use([Vt.call(e,t),Qt,se.call(e,t),...n])}}();window.__HEIMDALLR_OPTIONS__&&HEIMDALLR_BROWSER&&HEIMDALLR_BROWSER(window.__HEIMDALLR_OPTIONS__);
