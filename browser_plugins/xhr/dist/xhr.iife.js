var HEIMDALLR_XHR=function(E){"use strict";var t,R=((t=R||{}).NAME="@heimdallr-sdk",t),O=(E=>(E[E.FATAL=1]="FATAL",E[E.ERROR=2]="ERROR",E[E.WARN=3]="WARN",E[E.INFO=4]="INFO",E[E.DEBUG=5]="DEBUG",E))(O||{}),e=(E=>(E.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",E.USER_ID="HEIMDALLR_SDK_USER_ID",E.APP="HEIMDALLR_SDK_APP_ID",E))(e||{}),C=(E=>(E.GET="GET",E.POST="POST",E.PUT="PUT",E.DELETE="DELETE",E))(C||{}),r=(E=>(E[E.LIFECYCLE=1]="LIFECYCLE",E[E.ERROR=2]="ERROR",E[E.PERFORMANCE=3]="PERFORMANCE",E[E.API=4]="API",E[E.DOM=5]="DOM",E[E.ROUTE=6]="ROUTE",E[E.CONSOLE=7]="CONSOLE",E[E.RECORD=8]="RECORD",E[E.VUE=9]="VUE",E[E.CUSTOMER=10]="CUSTOMER",E[E.EXTEND=11]="EXTEND",E))(r||{}),s=(E=>(E[E.CODEERROR=21]="CODEERROR",E[E.RESOURCEERROR=22]="RESOURCEERROR",E[E.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",E[E.PAGECRASH=24]="PAGECRASH",E))(s||{}),o=(E=>(E[E.BEACON=1]="BEACON",E[E.IMG=2]="IMG",E[E.GET=3]="GET",E[E.POST=4]="POST",E))(o||{}),S=(E=>(E[E.CLICK=51]="CLICK",E))(S||{}),i=(E=>(E.LOG="log",E.INFO="info",E.WARN="warn",E.ERROR="error",E.ASSERT="assert",E))(i||{}),n=(E=>(E[E.XHR=41]="XHR",E[E.FETCH=42]="FETCH",E))(n||{}),l=(E=>(E[E.FMP=31]="FMP",E[E.FPS=32]="FPS",E[E.BASIC=33]="BASIC",E[E.VITALS=34]="VITALS",E[E.RESOURCE=35]="RESOURCE",E))(l||{}),L=(E=>(E[E.HASH=61]="HASH",E[E.HISTORY=62]="HISTORY",E))(L||{}),A=(E=>(E[E.CUSTOMER=111]="CUSTOMER",E))(A||{}),I=(E=>(E.LOCAL="local",E.SESSION="session",E.COOKIE="cookie",E.GLOBAL="global",E))(I||{}),T=(E=>(E[E.LOAD=11]="LOAD",E[E.UNLOAD=12]="UNLOAD",E))(T||{}),U=(E=>(E[E.MOBILE=1]="MOBILE",E[E.PC=2]="PC",E))(U||{}),D=(E=>(E[E.BROWSER=1]="BROWSER",E[E.WECHAT=2]="WECHAT",E[E.NODE=3]="NODE",E))(D||{}),a=(E=>(E[E.ROUTE=11]="ROUTE",E[E.CLICK=12]="CLICK",E[E.CONSOLE=13]="CONSOLE",E[E.XHR=14]="XHR",E[E.FETCH=15]="FETCH",E[E.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",E[E.RESOURCE=17]="RESOURCE",E[E.CODE_ERROR=18]="CODE_ERROR",E[E.CUSTOMER=19]="CUSTOMER",E[E.FRAMEWORK=20]="FRAMEWORK",E[E.LIFECYCLE=21]="LIFECYCLE",E[E.CRASH=22]="CRASH",E))(a||{}),N=(E=>(E[E.API=21]="API",E[E.ROUTE=22]="ROUTE",E[E.CLICK=23]="CLICK",E[E.ERROR=24]="ERROR",E[E.LIFECYCLE=25]="LIFECYCLE",E[E.CUSTOMER=26]="CUSTOMER",E))(N||{}),p=Object.defineProperty,c=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,h=(E,t,R)=>t in E?p(E,t,{enumerable:!0,configurable:!0,writable:!0,value:R}):E[t]=R,u=(E,t)=>{for(var R in t||(t={}))H.call(t,R)&&h(E,R,t[R]);if(c)for(var R of c(t))P.call(t,R)&&h(E,R,t[R]);return E};return function(t={}){const{ignoreUrls:R=[],reportResponds:e=!1}=t,C=XMLHttpRequest.prototype;return{name:"XHRPlugin",monitor(t){const{initUrl:O,uploadUrl:r}=this.getContext(),s=this,o=[...R,r,O].map((t=>E.getUrlPath(t)));E.replaceOld(C,"open",(E=>function(...t){this.httpCollect={req:{m:t[0]?t[0].toUpperCase():t[0],url:t[1]},res:{},t:s.getTime()},E.apply(this,t)})),E.replaceOld(C,"send",(R=>function(...O){const{req:C}=this.httpCollect,{url:r}=C;this.addEventListener("loadend",(function(){if(o.includes(E.getUrlPath(r)))return;const{responseType:R,response:S,status:i}=this;C.data=O[0];const n=s.getTime();e&&-1!==["","json","text"].indexOf(R)&&(this.httpCollect.res.dat="object"==typeof S?JSON.stringify(S):S),this.httpCollect.res.sta=i,this.httpCollect.et=n-this.httpCollect.t,t(this.httpCollect)})),R.apply(this,O)}))},transform(t){const R=E.generateUUID(),{req:{m:e,url:C,dat:s},et:o=0,res:{sta:S}}=t;return this.breadcrumb.unshift({lid:R,bt:a.XHR,l:200!=S?O.WARN:O.INFO,msg:`${e} "${C}" width "${JSON.stringify(s)}" took ${o} ms`,t:this.getTime()}),{lid:R,t:this.getTime(),e:r.API,dat:u({st:n.XHR},t)}}}}}(utils);
