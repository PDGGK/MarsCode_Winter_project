var HEIMDALLR_FETCH=function(){"use strict";var E,R=((E=R||{}).NAME="@heimdallr-sdk",E),O=(E=>(E[E.FATAL=1]="FATAL",E[E.ERROR=2]="ERROR",E[E.WARN=3]="WARN",E[E.INFO=4]="INFO",E[E.DEBUG=5]="DEBUG",E))(O||{}),C=(E=>(E.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",E.USER_ID="HEIMDALLR_SDK_USER_ID",E.APP="HEIMDALLR_SDK_APP_ID",E))(C||{}),t=(E=>(E.GET="GET",E.POST="POST",E.PUT="PUT",E.DELETE="DELETE",E))(t||{}),e=(E=>(E[E.LIFECYCLE=1]="LIFECYCLE",E[E.ERROR=2]="ERROR",E[E.PERFORMANCE=3]="PERFORMANCE",E[E.API=4]="API",E[E.DOM=5]="DOM",E[E.ROUTE=6]="ROUTE",E[E.CONSOLE=7]="CONSOLE",E[E.RECORD=8]="RECORD",E[E.VUE=9]="VUE",E[E.CUSTOMER=10]="CUSTOMER",E[E.EXTEND=11]="EXTEND",E))(e||{}),S=(E=>(E[E.CODEERROR=21]="CODEERROR",E[E.RESOURCEERROR=22]="RESOURCEERROR",E[E.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",E[E.PAGECRASH=24]="PAGECRASH",E))(S||{}),L=(E=>(E[E.BEACON=1]="BEACON",E[E.IMG=2]="IMG",E[E.GET=3]="GET",E[E.POST=4]="POST",E))(L||{}),A=(E=>(E[E.CLICK=51]="CLICK",E))(A||{}),T=(E=>(E.LOG="log",E.INFO="info",E.WARN="warn",E.ERROR="error",E.ASSERT="assert",E))(T||{}),r=(E=>(E[E.XHR=41]="XHR",E[E.FETCH=42]="FETCH",E))(r||{}),I=(E=>(E[E.FMP=31]="FMP",E[E.FPS=32]="FPS",E[E.BASIC=33]="BASIC",E[E.VITALS=34]="VITALS",E[E.RESOURCE=35]="RESOURCE",E))(I||{}),D=(E=>(E[E.HASH=61]="HASH",E[E.HISTORY=62]="HISTORY",E))(D||{}),N=(E=>(E[E.CUSTOMER=111]="CUSTOMER",E))(N||{}),U=(E=>(E.LOCAL="local",E.SESSION="session",E.COOKIE="cookie",E.GLOBAL="global",E))(U||{}),n=(E=>(E[E.LOAD=11]="LOAD",E[E.UNLOAD=12]="UNLOAD",E))(n||{}),o=(E=>(E[E.MOBILE=1]="MOBILE",E[E.PC=2]="PC",E))(o||{}),s=(E=>(E[E.BROWSER=1]="BROWSER",E[E.WECHAT=2]="WECHAT",E[E.NODE=3]="NODE",E))(s||{}),H=(E=>(E[E.ROUTE=11]="ROUTE",E[E.CLICK=12]="CLICK",E[E.CONSOLE=13]="CONSOLE",E[E.XHR=14]="XHR",E[E.FETCH=15]="FETCH",E[E.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",E[E.RESOURCE=17]="RESOURCE",E[E.CODE_ERROR=18]="CODE_ERROR",E[E.CUSTOMER=19]="CUSTOMER",E[E.FRAMEWORK=20]="FRAMEWORK",E[E.LIFECYCLE=21]="LIFECYCLE",E[E.CRASH=22]="CRASH",E))(H||{}),i=(E=>(E[E.API=21]="API",E[E.ROUTE=22]="ROUTE",E[E.CLICK=23]="CLICK",E[E.ERROR=24]="ERROR",E[E.LIFECYCLE=25]="LIFECYCLE",E[E.CUSTOMER=26]="CUSTOMER",E))(i||{});const P=E=>{const R=/^[a-zA-Z]+:\/\//.test(E);try{const{pathname:O}=new URL(E,R?void 0:"http://temporaryurl.com");return O.endsWith("/")&&O.length>1?O.slice(0,-1):O}catch(E){return""}};var a,F,M=((a=M||{}).NAME="@heimdallr-sdk",a),c=((F=c||{})[F.FATAL=1]="FATAL",F[F.ERROR=2]="ERROR",F[F.WARN=3]="WARN",F[F.INFO=4]="INFO",F[F.DEBUG=5]="DEBUG",F),l=(E=>(E.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",E.USER_ID="HEIMDALLR_SDK_USER_ID",E.APP="HEIMDALLR_SDK_APP_ID",E))(l||{}),x=(E=>(E.GET="GET",E.POST="POST",E.PUT="PUT",E.DELETE="DELETE",E))(x||{}),d=(E=>(E[E.LIFECYCLE=1]="LIFECYCLE",E[E.ERROR=2]="ERROR",E[E.PERFORMANCE=3]="PERFORMANCE",E[E.API=4]="API",E[E.DOM=5]="DOM",E[E.ROUTE=6]="ROUTE",E[E.CONSOLE=7]="CONSOLE",E[E.RECORD=8]="RECORD",E[E.VUE=9]="VUE",E[E.CUSTOMER=10]="CUSTOMER",E[E.EXTEND=11]="EXTEND",E))(d||{}),u=(E=>(E[E.CODEERROR=21]="CODEERROR",E[E.RESOURCEERROR=22]="RESOURCEERROR",E[E.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",E[E.PAGECRASH=24]="PAGECRASH",E))(u||{}),_=(E=>(E[E.BEACON=1]="BEACON",E[E.IMG=2]="IMG",E[E.GET=3]="GET",E[E.POST=4]="POST",E))(_||{}),G=(E=>(E[E.CLICK=51]="CLICK",E))(G||{}),h=(E=>(E.LOG="log",E.INFO="info",E.WARN="warn",E.ERROR="error",E.ASSERT="assert",E))(h||{}),m=(E=>(E[E.XHR=41]="XHR",E[E.FETCH=42]="FETCH",E))(m||{}),K=(E=>(E[E.FMP=31]="FMP",E[E.FPS=32]="FPS",E[E.BASIC=33]="BASIC",E[E.VITALS=34]="VITALS",E[E.RESOURCE=35]="RESOURCE",E))(K||{}),p=(E=>(E[E.HASH=61]="HASH",E[E.HISTORY=62]="HISTORY",E))(p||{}),B=(E=>(E[E.CUSTOMER=111]="CUSTOMER",E))(B||{}),f=(E=>(E.LOCAL="local",E.SESSION="session",E.COOKIE="cookie",E.GLOBAL="global",E))(f||{}),g=(E=>(E[E.LOAD=11]="LOAD",E[E.UNLOAD=12]="UNLOAD",E))(g||{}),W=(E=>(E[E.MOBILE=1]="MOBILE",E[E.PC=2]="PC",E))(W||{}),b=(E=>(E[E.BROWSER=1]="BROWSER",E[E.WECHAT=2]="WECHAT",E[E.NODE=3]="NODE",E))(b||{}),y=(E=>(E[E.ROUTE=11]="ROUTE",E[E.CLICK=12]="CLICK",E[E.CONSOLE=13]="CONSOLE",E[E.XHR=14]="XHR",E[E.FETCH=15]="FETCH",E[E.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",E[E.RESOURCE=17]="RESOURCE",E[E.CODE_ERROR=18]="CODE_ERROR",E[E.CUSTOMER=19]="CUSTOMER",E[E.FRAMEWORK=20]="FRAMEWORK",E[E.LIFECYCLE=21]="LIFECYCLE",E[E.CRASH=22]="CRASH",E))(y||{}),Y=(E=>(E[E.API=21]="API",E[E.ROUTE=22]="ROUTE",E[E.CLICK=23]="CLICK",E[E.ERROR=24]="ERROR",E[E.LIFECYCLE=25]="LIFECYCLE",E[E.CUSTOMER=26]="CUSTOMER",E))(Y||{}),w=Object.defineProperty,X=Object.defineProperties,v=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,k=(E,R,O)=>R in E?w(E,R,{enumerable:!0,configurable:!0,writable:!0,value:O}):E[R]=O,$=(E,R)=>{for(var O in R||(R={}))V.call(R,O)&&k(E,O,R[O]);if(J)for(var O of J(R))j.call(R,O)&&k(E,O,R[O]);return E};return function(E={}){const{ignoreUrls:R=[],reportResponds:C=!1}=E;return{name:"fetchPlugin",monitor(E){const{initUrl:O,uploadUrl:e}=this.getContext(),S=this,L=[...R,e,O].map((E=>P(E)));((E,R,O,C)=>{if(void 0!==E&&(R in E||C)){const C=O(E[R]);"function"==typeof C&&(E[R]=C)}})(window,"fetch",(R=>function(O,e={}){const A=S.getTime(),T={req:{url:O,m:e&&e.method||t.GET,dat:e&&e.body},t:A,res:{}},r=new Headers(e.headers||{});var I;Object.assign(r,{setRequestHeader:r.set}),I=$({},e),e=X(I,v({headers:r}));const D=L.includes(P(O));return R.apply(window,[O,e]).then((R=>{const O=R.clone(),t=S.getTime();return T.et=t-A,T.res.sta=O.status,O.text().then((R=>{D||(C&&(T.res.dat=R),E(T))})),R}),(R=>{if(D)return;const O=S.getTime();throw T.et=O-A,T.res.sta=0,E(T),R}))}))},transform(E){const R="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(E=>{const R=16*Math.random()|0;return("x"===E?R:3&R|8).toString(16)})),{req:{m:C,url:t,dat:S},et:L=0,res:{sta:A}}=E;return this.breadcrumb.unshift({lid:R,bt:H.FETCH,l:200!=A?O.WARN:O.INFO,msg:`${C} "${t}" width "${JSON.stringify(S)}" took ${L} ms`,t:this.getTime()}),{lid:R,t:this.getTime(),e:e.API,dat:$({st:r.FETCH},E)}}}}}();
