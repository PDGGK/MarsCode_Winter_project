var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;const s=(e,t)=>`${/^http(s|):\/\//.test(e||"")?e:`//${(e||"").replace(/^http(s|):\/\//,"")}`}/${"/"===(t||"")[0]?t.substring(1):t}`,E=e=>{const t=/^[a-zA-Z]+:\/\//.test(e);try{const{pathname:r}=new URL(e,t?void 0:"http://temporaryurl.com");return r.endsWith("/")&&r.length>1?r.slice(0,-1):r}catch(e){return""}},R=(e,t={})=>{const r=[];return Object.keys(t).forEach((e=>{r.push(`${e}=${t[e]}`)})),`${e}${-1!==e.indexOf("?")?"&":"?"}${r.join("&")}`},a=(e,s)=>{if(!e||!s)return null;const E=((e,s)=>{for(var E in s||(s={}))r.call(s,E)&&o(e,E,s[E]);if(t)for(var E of t(s))n.call(s,E)&&o(e,E,s[E]);return e})({},s),R=e.split(".");let a=E;for(const e of R){const t=a[e];if(!t)return null;a=t}return a},O=e=>Object.keys(e).map((t=>{const r=e[t];return`${encodeURIComponent(t)}=${encodeURIComponent("string"!=typeof r?JSON.stringify(r):r)}`})).join("&"),c=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),i=(e,t)=>{let r=0;return function(...n){const o=Date.now();o-r>=t&&(r=o,e.apply(this,n))}},C=(e,t,r,n)=>{if(void 0!==e&&(t in e||n)){const n=r(e[t]);"function"==typeof n&&(e[t]=n)}},S=(e,t)=>!isFinite(e)||isNaN(e)||!Number.isInteger(t)||t<0?e:parseFloat(e.toFixed(t)),l=e=>(new TextEncoder).encode(e).length,T=(e,t)=>{const r=(new TextEncoder).encode(e),n=new TextDecoder,o=[];let s=0;for(;s<r.length;){let e=s+t;for(;e>s&&128==(192&r[e]);)e--;o.push(n.decode(r.subarray(s,e))),s=e}return o};var u,p=((u=p||{}).NAME="@heimdallr-sdk",u);var L=(e=>(e[e.FATAL=1]="FATAL",e[e.ERROR=2]="ERROR",e[e.WARN=3]="WARN",e[e.INFO=4]="INFO",e[e.DEBUG=5]="DEBUG",e))(L||{}),I=(e=>(e.SESSION_ID="HEIMDALLR_SDK_SESSION_ID",e.USER_ID="HEIMDALLR_SDK_USER_ID",e.APP="HEIMDALLR_SDK_APP_ID",e))(I||{}),d=(e=>(e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e))(d||{}),A=(e=>(e[e.LIFECYCLE=1]="LIFECYCLE",e[e.ERROR=2]="ERROR",e[e.PERFORMANCE=3]="PERFORMANCE",e[e.API=4]="API",e[e.DOM=5]="DOM",e[e.ROUTE=6]="ROUTE",e[e.CONSOLE=7]="CONSOLE",e[e.RECORD=8]="RECORD",e[e.VUE=9]="VUE",e[e.CUSTOMER=10]="CUSTOMER",e[e.EXTEND=11]="EXTEND",e))(A||{}),x=(e=>(e[e.CODEERROR=21]="CODEERROR",e[e.RESOURCEERROR=22]="RESOURCEERROR",e[e.UNHANDLEDREJECTION=23]="UNHANDLEDREJECTION",e[e.PAGECRASH=24]="PAGECRASH",e))(x||{}),f=(e=>(e[e.BEACON=1]="BEACON",e[e.IMG=2]="IMG",e[e.GET=3]="GET",e[e.POST=4]="POST",e))(f||{}),N=(e=>(e[e.CLICK=51]="CLICK",e))(N||{}),U=(e=>(e.LOG="log",e.INFO="info",e.WARN="warn",e.ERROR="error",e.ASSERT="assert",e))(U||{}),D=(e=>(e[e.XHR=41]="XHR",e[e.FETCH=42]="FETCH",e))(D||{}),y=(e=>(e[e.FMP=31]="FMP",e[e.FPS=32]="FPS",e[e.BASIC=33]="BASIC",e[e.VITALS=34]="VITALS",e[e.RESOURCE=35]="RESOURCE",e))(y||{}),g=(e=>(e[e.HASH=61]="HASH",e[e.HISTORY=62]="HISTORY",e))(g||{}),m=(e=>(e[e.CUSTOMER=111]="CUSTOMER",e))(m||{}),P=(e=>(e.LOCAL="local",e.SESSION="session",e.COOKIE="cookie",e.GLOBAL="global",e))(P||{}),h=(e=>(e[e.LOAD=11]="LOAD",e[e.UNLOAD=12]="UNLOAD",e))(h||{}),H=(e=>(e[e.MOBILE=1]="MOBILE",e[e.PC=2]="PC",e))(H||{}),F=(e=>(e[e.BROWSER=1]="BROWSER",e[e.WECHAT=2]="WECHAT",e[e.NODE=3]="NODE",e))(F||{}),M=(e=>(e[e.ROUTE=11]="ROUTE",e[e.CLICK=12]="CLICK",e[e.CONSOLE=13]="CONSOLE",e[e.XHR=14]="XHR",e[e.FETCH=15]="FETCH",e[e.UNHANDLEDREJECTION=16]="UNHANDLEDREJECTION",e[e.RESOURCE=17]="RESOURCE",e[e.CODE_ERROR=18]="CODE_ERROR",e[e.CUSTOMER=19]="CUSTOMER",e[e.FRAMEWORK=20]="FRAMEWORK",e[e.LIFECYCLE=21]="LIFECYCLE",e[e.CRASH=22]="CRASH",e))(M||{}),w=(e=>(e[e.API=21]="API",e[e.ROUTE=22]="ROUTE",e[e.CLICK=23]="CLICK",e[e.ERROR=24]="ERROR",e[e.LIFECYCLE=25]="LIFECYCLE",e[e.CUSTOMER=26]="CUSTOMER",e))(w||{});const $=e=>{let t=null;switch(e){case P.LOCAL:t=localStorage;break;case P.SESSION:t=sessionStorage}return t},b=(e,t,r=!0)=>{if(!e||!t)return"";const n=$(e);if(!n)return"";let o="";try{const e=t.split("."),[s]=e;o=n.getItem(s),r&&(o=JSON.parse(o),e.length>1&&(o=e.slice(1).reduce(((e,t)=>e[t]),o)))}catch(e){console.error("[@heimdallr-sdk]:",e)}return o},G=(e,t,r)=>{if(!t)return;const n=$(e);n&&n.setItem(t,JSON.stringify(r))},v=(e,t,r)=>{if(!e||!t||!r)return;const n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3),document.cookie=`${e}=${encodeURIComponent(t)};expires=${n.toUTCString()}`},B=e=>{if(!e)return"";const t=document.cookie.match(new RegExp(`(^| )${e}=([^;]*)(;|$)`));return null!=t?decodeURIComponent(t[2]):""},_=e=>{if(!e)return;const t=new Date;t.setTime(t.getTime()-1);const r=B(e);null!=r&&(document.cookie=`${e}=${r};expires=${t.toUTCString()}`)},K=(e,t)=>{if(!e||"string"!=typeof e)return console.error("Invalid URL"),!1;if(!t||"object"!=typeof t)return console.error("Invalid data"),!1;const r=new FormData;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];"string"==typeof n||n instanceof Blob||(n=JSON.stringify(n)),r.append(e,n)}return navigator.sendBeacon(e,r)},j=(e,t)=>J(d.GET,e,t),k=(e,t)=>J(d.POST,e,t),J=(e,t,r)=>new Promise(((n,o)=>{const s=new XMLHttpRequest;if(e===d.GET&&r){const e=new URLSearchParams(r),n=t.includes("?")?"&":"?";t+=`${n}${e.toString()}`}s.open(e,t,!0),e!==d.GET&&("string"==typeof r||r instanceof URLSearchParams?s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):s.setRequestHeader("Content-Type","application/json;charset=UTF-8")),s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){const e=(e=>{const t={};return e.trim().split(/[\r\n]+/).forEach((e=>{const[r,n]=e.split(": ");t[r]=n})),t})(s.getAllResponseHeaders());if(s.status>=200&&s.status<300){try{const t=s.responseText?JSON.parse(s.responseText):null;n({status:s.status,statusText:s.statusText,headers:e,data:t})}catch(e){o(new Error(`Failed to parse response: ${s.responseText}`))}return}o({status:s.status,statusText:s.statusText,headers:e,data:s.responseText})}},s.onerror=()=>{o(new Error("Network error"))};try{if(e!==d.GET)return"string"==typeof r||r instanceof URLSearchParams?void s.send(r):void s.send(JSON.stringify(r));s.send()}catch(e){o(e)}})),W=(e,t)=>{const r=O(t),n=e.includes("?")?"&":"?",o=`${e}${n}${r}`,s=new Image;s.src=o,setTimeout((()=>{s.src=""}),0)};export{K as beacon,l as countBytes,_ as delCookie,S as formatDecimal,s as formateUrlPath,c as generateUUID,j as get,B as getCookie,a as getDeepPropByDot,b as getStore,E as getUrlPath,W as imgRequest,O as obj2query,k as post,C as replaceOld,v as setCookie,G as setStore,R as setUrlQuery,T as splitStringByBytes,i as throttle,J as xhr};
